var assert  = require("assert"),
    should  = require("should"),
    regexp  = require("regexp"),
    fixture = require(__dirname+"/../fixtures/request_fixture_mac.json"),
    RequestContext  = require("..");

suite("RequestContext API", function(){
	describe('new RequestContext(requextObject)', function(){
		it('should fail if no requestObject is passed in', function(){
			console.log(fixture);
			assert.throws(function(){ var rc = new RequestContext()}, Error);
		});
	});


	describe('getDevice() return string', function(){
		it('should be functional', function(){
			var req = new RequestContext({headers:{'user-agent':'test'},device:{type:'desktop'}});
			assert.equal(typeof req.getDevice, 'function');
			assert.equal(typeof req.getDevice(), 'string');
		});
	});
	describe('parseRoute(req.params) return true', function(){
		it('should be functional', function(){
			var req = new RequestContext({headers:{'user-agent':'test'},device:'bar'});
			assert.equal(typeof req.parseRoute, 'function');
			assert.equal(req.parseRoute({params:{arg1:"api", arg2:"1", arg3:"category",arg4:"123",arg5:"products"}}), true);
		});
	});
	describe('getParams() return array', function(){
		it('should be functional', function(){
			var req = new RequestContext({
					headers:{'user-agent':'test'},
			    		device:{type:'desktop'},
			    		params:{arg1:'api',arg2:'1',arg3:'category',arg4:'2345',arg5:'products',arg6:'123,455,322,3454,234'}});
			var params = req.getParams();
			assert.equal(typeof params, 'object');
			assert.equal(params.length, 6);
		});
	});
	describe('getHost() return hostname ', function(){
		it('should exist', function(){
			var req = new RequestContext(fixture);
			assert.equal(typeof req.getHostName, 'function');
		});
		it('should return string', function(){
			var req = new RequestContext({
					hostname:'14k.codemacys.fds.com',
					headers:{'user-agent':'test'},
			    		device:{type:'desktop'},
			    		params:{arg1:'api',arg2:'1',arg3:'category',arg4:'2345',arg5:'products',arg6:'123,455,322,3454,234'}});
			var hostname = req.getHostName();
			assert.equal(typeof hostname, 'string');
			assert.equal(hostname,'14k.codemacys.fds.com');
		});
	});
});
